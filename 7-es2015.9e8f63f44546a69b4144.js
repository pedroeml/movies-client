(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"ct+p":function(e,t,i){"use strict";i.r(t),i.d(t,"HomeModule",(function(){return k}));var n=i("ofXK"),r=i("Xa2L"),o=i("WSrY"),s=i("fXoL"),c=i("tk/3"),a=i("jQ2G");let l=(()=>{class e{constructor(e,t){this.http=e,this.config=t}getMovies(){return this.http.get(this.config.getMoviesApiUrl())}getMovie(e){return this.http.get(`${this.config.getMoviesApiUrl()}/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(s.Vb(c.b),s.Vb(a.a))},e.\u0275prov=s.Ib({token:e,factory:e.\u0275fac}),e})();var p=i("LRne"),h=i("lJxs"),u=i("JIr8"),m=function(e){return e.HORROR="Horror",e.COMEDY="Comedy",e.ACTION="Action",e.FANTASY="Fantasy",e.SCIFI="Sci-Fi",e}({});class v{constructor(e){this.id=e.id,this.name=e.name,this.genre=e.genre,this.release=e.release,this.videoUrl=e.videoUrl}}let f=(()=>{class e{constructor(e){this.restService=e,this.genres=[m.ACTION,m.COMEDY,m.FANTASY,m.HORROR,m.SCIFI]}getMovies(){return this.restService.getMovies().pipe(Object(h.a)(e=>e.map(e=>new v(e))),Object(u.a)(()=>Object(p.a)([])))}getMovie(e){return this.restService.getMovie(e).pipe(Object(h.a)(e=>new v(e)),Object(u.a)(()=>Object(p.a)(void 0)))}get movieGenres(){return this.genres}filterMoviesByGenre(e,t){return e.filter(e=>e.genre===t)}mapMoviesByGenre(e){return this.movieGenres.map(t=>this.filterMoviesByGenre(e,t))}}return e.\u0275fac=function(t){return new(t||e)(s.Vb(l))},e.\u0275prov=s.Ib({token:e,factory:e.\u0275fac}),e})(),g=(()=>{class e{}return e.\u0275mod=s.Kb({type:e}),e.\u0275inj=s.Jb({factory:function(t){return new(t||e)},providers:[f,l],imports:[[n.c,o.a]]}),e})();var b=i("cRhG"),d=i("tyNb"),M=i("vkgz"),w=i("eIep"),O=i("cp0P"),y=i("SxV6"),j=i("5+tZ"),C=i("bN/h");let I=(()=>{class e{constructor(e,t){this.profileService=e,this.movieService=t}loadUser(){return this.profileService.load().pipe(Object(y.a)())}loadMovies(){return this.movieService.getMovies().pipe(Object(h.a)(e=>this.movieService.mapMoviesByGenre(e)))}loadWatchedMovies(e,t){const i=e.watchedMovies.map(e=>e.id);return t&&t>0&&(i.length=t),Object(p.a)(i).pipe(Object(h.a)(e=>e.map(e=>this.movieService.getMovie(e))),Object(j.a)(e=>Object(O.a)(e)))}}return e.\u0275fac=function(t){return new(t||e)(s.Vb(C.a),s.Vb(f))},e.\u0275prov=s.Ib({token:e,factory:e.\u0275fac}),e})();var S=i("jhN1");function B(e,t){if(1&e&&(s.Rb(0,"li"),s.Nb(1,"img",1),s.Rb(2,"h4"),s.tc(3),s.Qb(),s.Qb()),2&e){const e=t.$implicit,i=s.cc();s.Bb(1),s.hc("src",i.getMovieImageUrl(e),s.nc),s.Bb(2),s.uc(e.name)}}let R=(()=>{class e{constructor(e){this.sanitizer=e}get movieGenre(){return this.title||this.movies.find(e=>!!e.genre).genre}getMovieImageUrl(e){const t=e.videoUrl.replace("www","img").replace("embed","vi")+"/0.jpg";return this.sanitizer.bypassSecurityTrustResourceUrl(t)}}return e.\u0275fac=function(t){return new(t||e)(s.Mb(S.b))},e.\u0275cmp=s.Gb({type:e,selectors:[["app-movie-row"]],inputs:{movies:"movies",title:"title"},decls:4,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"src"]],template:function(e,t){1&e&&(s.Rb(0,"h2"),s.tc(1),s.Qb(),s.Rb(2,"ul"),s.sc(3,B,4,2,"li",0),s.Qb()),2&e&&(s.Bb(1),s.uc(t.movieGenre),s.Bb(2),s.hc("ngForOf",t.movies))},directives:[n.j],styles:["h2[_ngcontent-%COMP%]{text-transform:uppercase;margin-top:2%;margin-bottom:1%}img[_ngcontent-%COMP%]{width:180px;height:auto}ul[_ngcontent-%COMP%]{width:auto;display:flex;flex-flow:row;overflow:auto;white-space:nowrap;list-style:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:180px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;margin-right:10px;white-space:normal;display:inline-block}"]}),e})();function G(e,t){if(1&e&&(s.Rb(0,"h1"),s.tc(1),s.Qb()),2&e){const e=s.cc();s.Bb(1),s.vc("Welcome back, ",e.userName,"!")}}function N(e,t){1&e&&s.Nb(0,"mat-spinner",5),2&e&&s.hc("diameter",100)}function x(e,t){if(1&e&&s.Nb(0,"app-movie-row",6),2&e){const e=s.cc();s.hc("title","Continue watching")("movies",e.watchedMovies)}}function F(e,t){if(1&e&&(s.Rb(0,"li"),s.Nb(1,"app-movie-row",7),s.Qb()),2&e){const e=t.$implicit;s.Bb(1),s.hc("movies",e)}}const P=[{path:"",component:(()=>{class e{constructor(e){this.service=e,this.loadUser(),this.loadMovies(),this.limit=5}get userName(){return this.user?`${this.user.firstName} ${this.user.lastName}`:""}get isLoading(){return!this.user||!this.moviesByGenre||!this.watchedMovies}loadUser(){this.service.loadUser().pipe(Object(M.a)(e=>{this.user=e}),Object(w.a)(e=>this.service.loadWatchedMovies(e,this.limit))).subscribe(e=>{this.watchedMovies=e})}loadMovies(){this.service.loadMovies().subscribe(e=>{this.moviesByGenre=e})}}return e.\u0275fac=function(t){return new(t||e)(s.Mb(I))},e.\u0275cmp=s.Gb({type:e,selectors:[["app-welcome"]],decls:5,vars:4,consts:[[4,"ngIf"],["matSuffix","","matTooltip","Loading...",3,"diameter",4,"ngIf"],["class","min-padding",3,"title","movies",4,"ngIf"],[1,"min-padding"],[4,"ngFor","ngForOf"],["matSuffix","","matTooltip","Loading...",3,"diameter"],[1,"min-padding",3,"title","movies"],[3,"movies"]],template:function(e,t){1&e&&(s.sc(0,G,2,1,"h1",0),s.sc(1,N,1,1,"mat-spinner",1),s.sc(2,x,1,2,"app-movie-row",2),s.Rb(3,"ul",3),s.sc(4,F,2,1,"li",4),s.Qb()),2&e&&(s.hc("ngIf",!!t.user),s.Bb(1),s.hc("ngIf",t.isLoading),s.Bb(1),s.hc("ngIf",t.watchedMovies),s.Bb(2),s.hc("ngForOf",t.moviesByGenre))},directives:[n.k,n.j,r.b,R],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column;justify-content:space-around}h1[_ngcontent-%COMP%]{align-self:center;margin-top:2%}ul[_ngcontent-%COMP%]{list-style:none}mat-spinner[_ngcontent-%COMP%]{margin:30% auto 70%}.min-padding[_ngcontent-%COMP%]{padding-left:1%}"]}),e})()}];let U=(()=>{class e{}return e.\u0275mod=s.Kb({type:e}),e.\u0275inj=s.Jb({factory:function(t){return new(t||e)},imports:[[d.f.forChild(P)],d.f]}),e})(),k=(()=>{class e{}return e.\u0275mod=s.Kb({type:e}),e.\u0275inj=s.Jb({factory:function(t){return new(t||e)},providers:[I],imports:[[n.c,U,r.a,g,b.ProfileModule]]}),e})()}}]);