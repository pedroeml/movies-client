(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"0n2z":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("fXoL"),o=i("tk/3"),n=i("jQ2G");let s=(()=>{class e{constructor(e,t){this.http=e,this.config=t}getMovies(){return this.http.get(this.config.getMoviesApiUrl())}getMovie(e){return this.http.get(`${this.config.getMoviesApiUrl()}/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(r.Vb(o.b),r.Vb(n.a))},e.\u0275prov=r.Ib({token:e,factory:e.\u0275fac}),e})()},MIah:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i("LRne"),o=i("cp0P"),n=i("lJxs"),s=i("JIr8"),a=i("5+tZ"),c=i("pjpR"),h=function(e){return e.HORROR="Horror",e.COMEDY="Comedy",e.ACTION="Action",e.FANTASY="Fantasy",e.SCIFI="Sci-Fi",e}({});class u{constructor(e){this.id=e.id,this.name=e.name,this.genre=e.genre,this.release=e.release,this.videoUrl=e.videoUrl}}var d=i("fXoL"),p=i("bN/h"),v=i("0n2z");let l=(()=>{class e{constructor(e,t){this.profileService=e,this.restService=t,this.genres=[h.ACTION,h.COMEDY,h.FANTASY,h.HORROR,h.SCIFI]}getMovies(){return this.restService.getMovies().pipe(Object(n.a)(e=>e.map(e=>new u(e))),Object(s.a)(()=>Object(r.a)([])))}getMovie(e){return this.restService.getMovie(e).pipe(Object(n.a)(e=>new u(e)),Object(s.a)(()=>Object(r.a)(void 0)))}get movieGenres(){return this.genres}filterMoviesByGenre(e,t){return e.filter(e=>e.genre===t)}mapMoviesByGenre(e){return this.movieGenres.map(t=>this.filterMoviesByGenre(e,t))}loadWatchedMovies(e,t){const i=e.watchedMovies.map(e=>e.id);return t&&t>0&&(i.length=t),Object(r.a)(i).pipe(Object(n.a)(e=>e.map(e=>this.getMovie(e))),Object(a.a)(e=>Object(o.a)(e)))}updateWatchedMovie(e,t){const i={watchedMovies:t.watchedMovies};return this.incrementViews(e,t),this.profileService.update(t.id,i)}incrementViews(e,t){const i=t.watchedMovies.findIndex(t=>t.id===e.id),r=-1!==i?t.watchedMovies.splice(i,1)[0].views+1:1,o=new c.a({id:e.id,views:r});t.watchedMovies.unshift(o)}}return e.\u0275fac=function(t){return new(t||e)(d.Vb(p.a),d.Vb(v.a))},e.\u0275prov=d.Ib({token:e,factory:e.\u0275fac}),e})()},ubTF:function(e,t,i){"use strict";i.r(t),i.d(t,"MovieModule",(function(){return w}));var r=i("ofXK"),o=i("Xa2L"),n=i("WSrY"),s=i("cRhG"),a=i("tyNb"),c=i("eIep"),h=i("lJxs"),u=i("vkgz"),d=i("SxV6"),p=i("fXoL"),v=i("jhN1"),l=i("bN/h"),b=i("MIah");function f(e,t){1&e&&p.Nb(0,"mat-spinner",2),2&e&&p.hc("diameter",100)}function m(e,t){if(1&e&&(p.Rb(0,"div"),p.Rb(1,"div",3),p.Nb(2,"iframe",4),p.Qb(),p.Rb(3,"h2",5),p.uc(4),p.Qb(),p.Rb(5,"h4",5),p.uc(6),p.Qb(),p.Qb()),2&e){const e=p.cc();p.Bb(2),p.hc("src",e.movieUrl,p.nc),p.Bb(2),p.vc(e.movie.name),p.Bb(2),p.xc("",e.movie.release," - ",e.movie.genre,"")}}const g=[{path:":id",component:(()=>{class e{constructor(e,t,i,r,o){this.route=e,this.router=t,this.sanitizer=i,this.profileService=r,this.service=o,this.load().subscribe()}get isLoading(){return!this.user||!this.movie}get movieUrl(){return this.sanitizer.bypassSecurityTrustResourceUrl(this.movie.videoUrl)}load(){return this.captureMovieId().pipe(Object(c.a)(e=>this.loadMovie(e)),Object(c.a)(()=>this.loadUser()),Object(c.a)(e=>this.updateWatchedMovie(this.movie,e)),Object(h.a)(()=>{}))}loadUser(){return this.profileService.load().pipe(Object(u.a)(e=>{this.user=e}))}loadMovie(e){return this.service.getMovie(e).pipe(Object(u.a)(e=>{this.movie=e,e||this.router.navigateByUrl("/home")}))}captureMovieId(){return this.route.params.pipe(Object(d.a)(),Object(h.a)(e=>e.id||""))}updateWatchedMovie(e,t){return this.service.updateWatchedMovie(e,t).pipe(Object(u.a)(e=>{this.user=e}))}}return e.\u0275fac=function(t){return new(t||e)(p.Mb(a.a),p.Mb(a.b),p.Mb(v.b),p.Mb(l.a),p.Mb(b.a))},e.\u0275cmp=p.Gb({type:e,selectors:[["app-movie-player"]],decls:2,vars:2,consts:[["matSuffix","","matTooltip","Loading...",3,"diameter",4,"ngIf"],[4,"ngIf"],["matSuffix","","matTooltip","Loading...",3,"diameter"],[1,"video-container"],["type","text/html","frameborder","0","allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture","allowfullscreen","",3,"src"],[1,"min-padding"]],template:function(e,t){1&e&&(p.tc(0,f,1,1,"mat-spinner",0),p.tc(1,m,7,4,"div",1)),2&e&&(p.hc("ngIf",t.isLoading),p.Bb(1),p.hc("ngIf",!t.isLoading))},directives:[r.k,o.b],styles:["[_nghost-%COMP%]{max-width:100%;display:flex;overflow:auto;flex-flow:column}mat-spinner[_ngcontent-%COMP%]{margin:30% auto 70%}div.video-container[_ngcontent-%COMP%]{position:relative;padding-bottom:56.25%;height:0}div.video-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}"]}),e})()},{path:"",redirectTo:"/home",pathMatch:"full"}];let M=(()=>{class e{}return e.\u0275mod=p.Kb({type:e}),e.\u0275inj=p.Jb({factory:function(t){return new(t||e)},imports:[[a.f.forChild(g)],a.f]}),e})();var O=i("0n2z");let w=(()=>{class e{}return e.\u0275mod=p.Kb({type:e}),e.\u0275inj=p.Jb({factory:function(t){return new(t||e)},providers:[b.a,O.a],imports:[[r.c,n.a,o.a,M,s.ProfileModule]]}),e})()}}]);