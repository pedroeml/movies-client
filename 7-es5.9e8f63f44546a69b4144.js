function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"ct+p":function(e,t,n){"use strict";n.r(t),n.d(t,"HomeModule",(function(){return Y}));var i,r,o,c,s=n("ofXK"),a=n("Xa2L"),u=n("WSrY"),l=n("fXoL"),f=n("tk/3"),h=n("jQ2G"),v=((i=function(){function e(t,n){_classCallCheck(this,e),this.http=t,this.config=n}return _createClass(e,[{key:"getMovies",value:function(){return this.http.get(this.config.getMoviesApiUrl())}},{key:"getMovie",value:function(e){return this.http.get("".concat(this.config.getMoviesApiUrl(),"/").concat(e))}}]),e}()).\u0275fac=function(e){return new(e||i)(l.Vb(f.b),l.Vb(h.a))},i.\u0275prov=l.Ib({token:i,factory:i.\u0275fac}),i),p=n("LRne"),m=n("lJxs"),g=n("JIr8"),b=function(e){return e.HORROR="Horror",e.COMEDY="Comedy",e.ACTION="Action",e.FANTASY="Fantasy",e.SCIFI="Sci-Fi",e}({}),d=function e(t){_classCallCheck(this,e),this.id=t.id,this.name=t.name,this.genre=t.genre,this.release=t.release,this.videoUrl=t.videoUrl},y=((o=function(){function e(t){_classCallCheck(this,e),this.restService=t,this.genres=[b.ACTION,b.COMEDY,b.FANTASY,b.HORROR,b.SCIFI]}return _createClass(e,[{key:"getMovies",value:function(){return this.restService.getMovies().pipe(Object(m.a)((function(e){return e.map((function(e){return new d(e)}))})),Object(g.a)((function(){return Object(p.a)([])})))}},{key:"getMovie",value:function(e){return this.restService.getMovie(e).pipe(Object(m.a)((function(e){return new d(e)})),Object(g.a)((function(){return Object(p.a)(void 0)})))}},{key:"filterMoviesByGenre",value:function(e,t){return e.filter((function(e){return e.genre===t}))}},{key:"mapMoviesByGenre",value:function(e){var t=this;return this.movieGenres.map((function(n){return t.filterMoviesByGenre(e,n)}))}},{key:"movieGenres",get:function(){return this.genres}}]),e}()).\u0275fac=function(e){return new(e||o)(l.Vb(v))},o.\u0275prov=l.Ib({token:o,factory:o.\u0275fac}),o),C=((r=function e(){_classCallCheck(this,e)}).\u0275mod=l.Kb({type:r}),r.\u0275inj=l.Jb({factory:function(e){return new(e||r)},providers:[y,v],imports:[[s.c,u.a]]}),r),w=n("cRhG"),M=n("tyNb"),k=n("vkgz"),O=n("eIep"),_=n("cp0P"),j=n("SxV6"),I=n("5+tZ"),S=n("bN/h"),B=((c=function(){function e(t,n){_classCallCheck(this,e),this.profileService=t,this.movieService=n}return _createClass(e,[{key:"loadUser",value:function(){return this.profileService.load().pipe(Object(j.a)())}},{key:"loadMovies",value:function(){var e=this;return this.movieService.getMovies().pipe(Object(m.a)((function(t){return e.movieService.mapMoviesByGenre(t)})))}},{key:"loadWatchedMovies",value:function(e,t){var n=this,i=e.watchedMovies.map((function(e){return e.id}));return t&&t>0&&(i.length=t),Object(p.a)(i).pipe(Object(m.a)((function(e){return e.map((function(e){return n.movieService.getMovie(e)}))})),Object(I.a)((function(e){return Object(_.a)(e)})))}}]),e}()).\u0275fac=function(e){return new(e||c)(l.Vb(S.a),l.Vb(y))},c.\u0275prov=l.Ib({token:c,factory:c.\u0275fac}),c),P=n("jhN1");function R(e,t){if(1&e&&(l.Rb(0,"li"),l.Nb(1,"img",1),l.Rb(2,"h4"),l.tc(3),l.Qb(),l.Qb()),2&e){var n=t.$implicit,i=l.cc();l.Bb(1),l.hc("src",i.getMovieImageUrl(n),l.nc),l.Bb(2),l.uc(n.name)}}var G,N=((G=function(){function e(t){_classCallCheck(this,e),this.sanitizer=t}return _createClass(e,[{key:"getMovieImageUrl",value:function(e){var t=e.videoUrl.replace("www","img").replace("embed","vi")+"/0.jpg";return this.sanitizer.bypassSecurityTrustResourceUrl(t)}},{key:"movieGenre",get:function(){return this.title||this.movies.find((function(e){return!!e.genre})).genre}}]),e}()).\u0275fac=function(e){return new(e||G)(l.Mb(P.b))},G.\u0275cmp=l.Gb({type:G,selectors:[["app-movie-row"]],inputs:{movies:"movies",title:"title"},decls:4,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"src"]],template:function(e,t){1&e&&(l.Rb(0,"h2"),l.tc(1),l.Qb(),l.Rb(2,"ul"),l.sc(3,R,4,2,"li",0),l.Qb()),2&e&&(l.Bb(1),l.uc(t.movieGenre),l.Bb(2),l.hc("ngForOf",t.movies))},directives:[s.j],styles:["h2[_ngcontent-%COMP%]{text-transform:uppercase;margin-top:2%;margin-bottom:1%}img[_ngcontent-%COMP%]{width:180px;height:auto}ul[_ngcontent-%COMP%]{width:auto;display:flex;flex-flow:row;overflow:auto;white-space:nowrap;list-style:none;padding-left:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:180px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;margin-right:10px;white-space:normal;display:inline-block}"]}),G);function x(e,t){if(1&e&&(l.Rb(0,"h1"),l.tc(1),l.Qb()),2&e){var n=l.cc();l.Bb(1),l.vc("Welcome back, ",n.userName,"!")}}function F(e,t){1&e&&l.Nb(0,"mat-spinner",5),2&e&&l.hc("diameter",100)}function U(e,t){if(1&e&&l.Nb(0,"app-movie-row",6),2&e){var n=l.cc();l.hc("title","Continue watching")("movies",n.watchedMovies)}}function A(e,t){if(1&e&&(l.Rb(0,"li"),l.Nb(1,"app-movie-row",7),l.Qb()),2&e){var n=t.$implicit;l.Bb(1),l.hc("movies",n)}}var Q,T,J,L=[{path:"",component:(Q=function(){function e(t){_classCallCheck(this,e),this.service=t,this.loadUser(),this.loadMovies(),this.limit=5}return _createClass(e,[{key:"loadUser",value:function(){var e=this;this.service.loadUser().pipe(Object(k.a)((function(t){e.user=t})),Object(O.a)((function(t){return e.service.loadWatchedMovies(t,e.limit)}))).subscribe((function(t){e.watchedMovies=t}))}},{key:"loadMovies",value:function(){var e=this;this.service.loadMovies().subscribe((function(t){e.moviesByGenre=t}))}},{key:"userName",get:function(){return this.user?"".concat(this.user.firstName," ").concat(this.user.lastName):""}},{key:"isLoading",get:function(){return!this.user||!this.moviesByGenre||!this.watchedMovies}}]),e}(),Q.\u0275fac=function(e){return new(e||Q)(l.Mb(B))},Q.\u0275cmp=l.Gb({type:Q,selectors:[["app-welcome"]],decls:5,vars:4,consts:[[4,"ngIf"],["matSuffix","","matTooltip","Loading...",3,"diameter",4,"ngIf"],["class","min-padding",3,"title","movies",4,"ngIf"],[1,"min-padding"],[4,"ngFor","ngForOf"],["matSuffix","","matTooltip","Loading...",3,"diameter"],[1,"min-padding",3,"title","movies"],[3,"movies"]],template:function(e,t){1&e&&(l.sc(0,x,2,1,"h1",0),l.sc(1,F,1,1,"mat-spinner",1),l.sc(2,U,1,2,"app-movie-row",2),l.Rb(3,"ul",3),l.sc(4,A,2,1,"li",4),l.Qb()),2&e&&(l.hc("ngIf",!!t.user),l.Bb(1),l.hc("ngIf",t.isLoading),l.Bb(1),l.hc("ngIf",t.watchedMovies),l.Bb(2),l.hc("ngForOf",t.moviesByGenre))},directives:[s.k,s.j,a.b,N],styles:["[_nghost-%COMP%]{display:flex;flex-flow:column;justify-content:space-around}h1[_ngcontent-%COMP%]{align-self:center;margin-top:2%}ul[_ngcontent-%COMP%]{list-style:none}mat-spinner[_ngcontent-%COMP%]{margin:30% auto 70%}.min-padding[_ngcontent-%COMP%]{padding-left:1%}"]}),Q)}],V=((J=function e(){_classCallCheck(this,e)}).\u0275mod=l.Kb({type:J}),J.\u0275inj=l.Jb({factory:function(e){return new(e||J)},imports:[[M.f.forChild(L)],M.f]}),J),Y=((T=function e(){_classCallCheck(this,e)}).\u0275mod=l.Kb({type:T}),T.\u0275inj=l.Jb({factory:function(e){return new(e||T)},providers:[B],imports:[[s.c,V,a.a,C,w.ProfileModule]]}),T)}}]);