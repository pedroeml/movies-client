(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"0n2z":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("fXoL"),n=i("tk/3"),o=i("jQ2G");let s=(()=>{class e{constructor(e,t){this.http=e,this.config=t}getMovies(){return this.http.get(this.config.getMoviesApiUrl())}getMovie(e){return this.http.get(`${this.config.getMoviesApiUrl()}/${e}`)}}return e.\u0275fac=function(t){return new(t||e)(r.Wb(n.b),r.Wb(o.a))},e.\u0275prov=r.Jb({token:e,factory:e.\u0275fac}),e})()},MIah:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i("LRne"),n=i("cp0P"),o=i("lJxs"),s=i("JIr8"),a=i("5+tZ"),c=i("pjpR"),h=function(e){return e.HORROR="Horror",e.COMEDY="Comedy",e.ACTION="Action",e.FANTASY="Fantasy",e.SCIFI="Sci-Fi",e}({});class p{constructor(e){this.id=e.id,this.name=e.name,this.genre=e.genre,this.release=e.release,this.videoUrl=e.videoUrl}}var u=i("fXoL"),d=i("bN/h"),v=i("0n2z");let l=(()=>{class e{constructor(e,t){this.profileService=e,this.restService=t,this.genres=[h.ACTION,h.COMEDY,h.FANTASY,h.HORROR,h.SCIFI]}getMovies(){return this.restService.getMovies().pipe(Object(o.a)(e=>e.map(e=>new p(e))),Object(s.a)(()=>Object(r.a)([])))}getMovie(e){return this.restService.getMovie(e).pipe(Object(o.a)(e=>new p(e)),Object(s.a)(()=>Object(r.a)(void 0)))}get movieGenres(){return this.genres}filterMoviesByGenre(e,t){return e.filter(e=>e.genre===t)}mapMoviesByGenre(e){return this.movieGenres.map(t=>this.filterMoviesByGenre(e,t))}loadWatchedMovies(e,t){const i=e.watchedMovies.map(e=>e.id);return t&&t>0&&(i.length=t),Object(r.a)(i).pipe(Object(o.a)(e=>e.map(e=>this.getMovie(e))),Object(a.a)(e=>Object(n.a)(e)))}updateWatchedMovie(e,t){const i={watchedMovies:t.watchedMovies};return this.incrementViews(e,t),this.profileService.update(t.id,i)}incrementViews(e,t){const i=t.watchedMovies.findIndex(t=>t.id===e.id),r=-1!==i?t.watchedMovies.splice(i,1)[0].views+1:1,n=new c.a({id:e.id,views:r});t.watchedMovies.unshift(n)}}return e.\u0275fac=function(t){return new(t||e)(u.Wb(d.a),u.Wb(v.a))},e.\u0275prov=u.Jb({token:e,factory:e.\u0275fac}),e})()},ubTF:function(e,t,i){"use strict";i.r(t),i.d(t,"MovieModule",(function(){return w}));var r=i("ofXK"),n=i("Xa2L"),o=i("WSrY"),s=i("cRhG"),a=i("tyNb"),c=i("eIep"),h=i("lJxs"),p=i("vkgz"),u=i("SxV6"),d=i("fXoL"),v=i("jhN1"),l=i("bN/h"),b=i("MIah");function f(e,t){1&e&&d.Ob(0,"mat-spinner",2),2&e&&d.ic("diameter",100)}function m(e,t){if(1&e&&(d.Sb(0,"div"),d.Sb(1,"div",3),d.Ob(2,"iframe",4),d.Rb(),d.Sb(3,"h2",5),d.wc(4),d.Rb(),d.Sb(5,"h4",5),d.wc(6),d.Rb(),d.Rb()),2&e){const e=d.dc();d.Bb(2),d.ic("src",e.movieUrl,d.pc),d.Bb(2),d.xc(e.movie.name),d.Bb(2),d.zc("",e.movie.release," - ",e.movie.genre,"")}}const g=[{path:":id",component:(()=>{class e{constructor(e,t,i,r,n){this.route=e,this.router=t,this.sanitizer=i,this.profileService=r,this.service=n,this.load().subscribe()}get isLoading(){return!this.user||!this.movie}get movieUrl(){return this.sanitizer.bypassSecurityTrustResourceUrl(this.movie.videoUrl)}load(){return this.captureMovieId().pipe(Object(c.a)(e=>this.loadMovie(e)),Object(c.a)(()=>this.loadUser()),Object(c.a)(e=>this.updateWatchedMovie(this.movie,e)),Object(h.a)(()=>{}))}loadUser(){return this.profileService.load().pipe(Object(p.a)(e=>{this.user=e}))}loadMovie(e){return this.service.getMovie(e).pipe(Object(p.a)(e=>{this.movie=e,e||this.router.navigateByUrl("/home")}))}captureMovieId(){return this.route.params.pipe(Object(u.a)(),Object(h.a)(e=>e.id||""))}updateWatchedMovie(e,t){return this.service.updateWatchedMovie(e,t).pipe(Object(p.a)(e=>{this.user=e}))}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(a.a),d.Nb(a.b),d.Nb(v.b),d.Nb(l.a),d.Nb(b.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-movie-player"]],decls:2,vars:2,consts:[["matSuffix","","class","page-spinner",3,"diameter",4,"ngIf"],[4,"ngIf"],["matSuffix","",1,"page-spinner",3,"diameter"],[1,"video-container"],["type","text/html","frameborder","0","allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture","allowfullscreen","",3,"src"],[1,"min-padding"]],template:function(e,t){1&e&&(d.vc(0,f,1,1,"mat-spinner",0),d.vc(1,m,7,4,"div",1)),2&e&&(d.ic("ngIf",t.isLoading),d.Bb(1),d.ic("ngIf",!t.isLoading))},directives:[r.k,n.b],styles:["[_nghost-%COMP%]{max-width:100%;display:flex;overflow:auto;flex-flow:column}div.video-container[_ngcontent-%COMP%]{position:relative;padding-bottom:56.25%;height:0}div.video-container[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}"]}),e})()},{path:"",redirectTo:"/home",pathMatch:"full"}];let M=(()=>{class e{}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},imports:[[a.f.forChild(g)],a.f]}),e})();var O=i("0n2z");let w=(()=>{class e{}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},providers:[b.a,O.a],imports:[[r.c,o.a,n.a,M,s.ProfileModule]]}),e})()}}]);